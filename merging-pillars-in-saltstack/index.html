<!DOCTYPE html><html lang="en" data-mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="Merging Pillars in SaltStack" /><meta name="author" content="Iván Ádám Vári" /><meta property="og:locale" content="en" /><meta name="description" content="Merging Pillars in SaltStack is supported but somewhat limited. In this post, I reveal a technique to utilise Jinja2 templating for pillar manipulation." /><meta property="og:description" content="Merging Pillars in SaltStack is supported but somewhat limited. In this post, I reveal a technique to utilise Jinja2 templating for pillar manipulation." /><link rel="canonical" href="https://ivanvari.com/merging-pillars-in-saltstack/" /><meta property="og:url" content="https://ivanvari.com/merging-pillars-in-saltstack/" /><meta property="og:site_name" content="Ivan Adam Vari" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2014-08-16T23:26:41+02:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Merging Pillars in SaltStack" /><meta name="twitter:site" content="@twitter_username" /><meta name="twitter:creator" content="@Iván Ádám Vári" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Iván Ádám Vári"},"dateModified":"2014-08-16T23:26:41+02:00","datePublished":"2014-08-16T23:26:41+02:00","description":"Merging Pillars in SaltStack is supported but somewhat limited. In this post, I reveal a technique to utilise Jinja2 templating for pillar manipulation.","headline":"Merging Pillars in SaltStack","mainEntityOfPage":{"@type":"WebPage","@id":"https://ivanvari.com/merging-pillars-in-saltstack/"},"url":"https://ivanvari.com/merging-pillars-in-saltstack/"}</script><title>Merging Pillars in SaltStack | Ivan Adam Vari</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Ivan Adam Vari"><meta name="application-name" content="Ivan Adam Vari"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"> <script async src="https://www.googletagmanager.com/gtag/js?id=G-GST9H3668K"></script> <script> window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-GST9H3668K'); </script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src=" /assets/img/avatar.png " alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Ivan Adam Vari</a></div><div class="site-subtitle font-italic">A minimalist SysOps/DevOps Craftsman</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <a href="https://github.com/variia" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['ivan.adam.vari','ivanvari.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="https://www.linkedin.com/profile/view?id=ADEAAAZ6wwEBp7FjAqg_m7ZK8y148UI70Cyn9n8" aria-label="linkedin" target="_blank" rel="noopener"> <i class="fab fa-linkedin"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Merging Pillars in SaltStack</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Merging Pillars in SaltStack</h1><div class="post-meta text-muted"><div> By <em> <a href="https://github.com/variia">Iván Ádám Vári</a> </em></div><div class="d-flex"><div> <span> Posted <em class="timeago" data-ts="1408224401" data-toggle="tooltip" data-placement="bottom" data-tooltip-df="llll" > 2014-08-16 </em> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="684 words"> <em>3 min</em> read</span></div></div></div><div class="post-content"><p>Merging or joining <a href="http://salt.readthedocs.org/en/latest/topics/pillar/" target="_blank">Pillars</a> in SaltStack is supported but somewhat limited. It took me some time to work out a clean solution to support a specific manipulation so to make this easier, I am going to share my real life example.</p><h2 id="merging-pillars-in-saltstack"><span class="mr-2">Merging Pillars in SaltStack</span><a href="#merging-pillars-in-saltstack" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>I wrote a reasonably complex formula to manage our DNS (bind9) servers including zone files. As a common approach, I decided to use Pillar for configuration to make the formula generic and reusable.</p><p>My formula required the following Pillar data (YAML):</p><div class="language-yaml highlighter-rouge"><div class="code-header"> <span data-label-text="YAML"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
</pre><td class="rouge-code"><pre><span class="na">bind</span><span class="pi">:</span>
  <span class="na">config</span><span class="pi">:</span>
    <span class="na">user</span><span class="pi">:</span> <span class="s">root</span>
    <span class="na">group</span><span class="pi">:</span> <span class="s">named</span>
    <span class="na">mode</span><span class="pi">:</span> <span class="m">640</span>
    <span class="na">custom</span><span class="pi">:</span>
      <span class="na">allow-query</span><span class="pi">:</span>
        <span class="pi">-</span> <span class="s">127.0.0.1</span>
        <span class="pi">-</span> <span class="s">192.168.1.0/24</span>
      <span class="na">allow-transfer</span><span class="pi">:</span>
        <span class="pi">-</span> <span class="s">127.0.0.1</span>
        <span class="pi">-</span> <span class="s">192.168.1.0/24</span>
      <span class="na">recursion</span><span class="pi">:</span> <span class="s2">"</span><span class="s">yes"</span>
      <span class="na">zone-statistics</span><span class="pi">:</span> <span class="s2">"</span><span class="s">yes"</span>
      <span class="na">transfer-format</span><span class="pi">:</span> <span class="s">many-answers</span>
      <span class="na">interface-interval</span><span class="pi">:</span> <span class="m">0</span>
  <span class="na">zones</span><span class="pi">:</span>
    <span class="na">domain.com</span><span class="pi">:</span>
      <span class="na">config</span><span class="pi">:</span>
        <span class="na">type</span><span class="pi">:</span> <span class="s">master</span>
        <span class="na">file</span><span class="pi">:</span> <span class="s">domain.com.hosts</span>
        <span class="na">also-notify</span><span class="pi">:</span>
          <span class="pi">-</span> <span class="s">192.168.1.1</span>
          <span class="pi">-</span> <span class="s">192.168.1.2</span>
      <span class="na">soa</span><span class="pi">:</span>
        <span class="na">ttl</span><span class="pi">:</span> <span class="s">43200 ; 12 hours</span>
        <span class="na">email</span><span class="pi">:</span> <span class="s">hostmaster.domain.com.</span>
        <span class="na">refresh</span><span class="pi">:</span> <span class="s">10800 ; 3h refresh</span>
        <span class="na">retry</span><span class="pi">:</span> <span class="s">3600 ; 1h retry</span>
        <span class="na">expire</span><span class="pi">:</span> <span class="s">604800 ; 1w expire</span>
        <span class="na">minimum</span><span class="pi">:</span> <span class="s">10800 ; 3h minimum</span>
        <span class="na">ns</span><span class="pi">:</span>
          <span class="pi">-</span> <span class="s">ns1.domain.com.</span>
          <span class="pi">-</span> <span class="s">ns6.otherdomain.net.</span>
          <span class="pi">-</span> <span class="s">ns7.other.sub.domain.org.</span>
    <span class="na">sub.domain.org</span><span class="pi">:</span>
      <span class="na">config</span><span class="pi">:</span>
        <span class="na">type</span><span class="pi">:</span> <span class="s">slave</span>
        <span class="na">file</span><span class="pi">:</span> <span class="s">slaves/sub.domain.org.hosts</span>
        <span class="na">masters</span><span class="pi">:</span>
          <span class="pi">-</span> <span class="s">192.168.1.1</span>
          <span class="pi">-</span> <span class="s">192.168.1.2</span>
    <span class="na">sub.domain.net</span><span class="pi">:</span>
      <span class="na">config</span><span class="pi">:</span>
        <span class="na">type</span><span class="pi">:</span> <span class="s">forward</span>
        <span class="na">forward</span><span class="pi">:</span> <span class="s">only</span>
        <span class="na">forwarders</span><span class="pi">:</span>
          <span class="pi">-</span> <span class="s">172.16.1.1</span>
</pre></table></code></div></div><p>To reuse my formula, I needed slightly different pillar for each DNS server but I wanted to reuse existing details to avoid duplication and pollution hence I ended up splitting the pillar into few files:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>/srv/salt/pillar/base/bind/named.sls
/srv/salt/pillar/base/bind/zones-master.sls
/srv/salt/pillar/base/bind/zones-slave.sls
/srv/salt/pillar/base/bind/zones-other.sls
</pre></table></code></div></div><p>This allows the use or import of the <code class="language-plaintext highlighter-rouge">named.sls</code> (core config) for every server and depending on “role” even additional zones as required:</p><p><code class="language-plaintext highlighter-rouge">/srv/salt/pillar/base/bind/named.sls</code></p><div class="language-yaml highlighter-rouge"><div class="code-header"> <span data-label-text="YAML"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="na">bind</span><span class="pi">:</span>
  <span class="na">config</span><span class="pi">:</span>
    <span class="na">custom</span><span class="pi">:</span>
      <span class="s">...</span>
      <span class="s">...</span>
</pre></table></code></div></div><p><code class="language-plaintext highlighter-rouge">/srv/salt/pillar/base/bind/zones-master.sls</code></p><div class="language-yaml highlighter-rouge"><div class="code-header"> <span data-label-text="YAML"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="na">bind</span><span class="pi">:</span>
  <span class="na">zones</span><span class="pi">:</span>
    <span class="na">domain.com</span><span class="pi">:</span>
      <span class="s">...</span>
      <span class="s">...</span>
</pre></table></code></div></div><p>First, I tried adding <code class="language-plaintext highlighter-rouge">init.sls</code> with the ”include” statement:</p><div class="language-yaml highlighter-rouge"><div class="code-header"> <span data-label-text="YAML"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre><span class="na">include</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="s">bind.named</span>
<span class="pi">{</span><span class="err">%</span><span class="nv">- if grains</span><span class="pi">[</span><span class="s1">'</span><span class="s">dnsrole'</span><span class="pi">]</span> <span class="nv">== 'master' %</span><span class="pi">}</span>
  <span class="pi">-</span> <span class="s">bind.zones-master</span>
  <span class="pi">-</span> <span class="s">bind.zones-other</span>
<span class="pi">{</span><span class="err">%</span><span class="nv">- endif %</span><span class="pi">}</span>

</pre></table></code></div></div><p>This did not work as expected, actually it overrides either the first subkey of the <code class="language-plaintext highlighter-rouge">named.sls</code> (custom) or the zone file (zone) depending on which gets read first during compile.</p><p>I could have used the <a href="http://salt.readthedocs.org/en/latest/topics/pillar/" target="_blank">include statement with the nesting </a>but it only works if I restructure the zone files and remove nesting from the bind key as well as include one zone.</p><p>One option was to move this logic into the <code class="language-plaintext highlighter-rouge">top.sls</code>:</p><div class="language-yaml highlighter-rouge"><div class="code-header"> <span data-label-text="YAML"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="na">base</span><span class="pi">:</span>
  <span class="s1">'</span><span class="s">roles:dns'</span><span class="err">:</span>
    <span class="pi">-</span> <span class="na">match</span><span class="pi">:</span> <span class="s">grain</span>
    <span class="pi">-</span> <span class="s">bind.named</span>
    <span class="pi">-</span> <span class="s">bind.zones-master</span>
</pre></table></code></div></div><p>This worked perfectly, my pillars were merged exactly the I way I wanted. However, I did not want to move a messy if-else logic there to target master/slave servers differently. Adding the if-else logic to the zone files looked not so ideal, changing the grain structure for better targeting seemed also just “too much” for what I needed to accomplish.</p><h4 id="template-engine-to-the-rescue"><span class="mr-2">Template Engine to the Rescue</span><a href="#template-engine-to-the-rescue" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h4></h4><p>My solution was hiding <a href="http://salt.readthedocs.org/en/latest/ref/renderers/all/salt.renderers.jinja.html" target="_blank">here</a>, I just had to compose the recipe myself. This method can be used in state files as well giving you the much needed power of code reuse.</p><p><code class="language-plaintext highlighter-rouge">/srv/salt/pillar/base/bind/init.sls</code></p><div class="language-yaml highlighter-rouge"><div class="code-header"> <span data-label-text="YAML"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
</pre><td class="rouge-code"><pre><span class="pi">{</span><span class="err">%</span><span class="nv">- import_yaml 'bind/named.sls' as named with context -%</span><span class="pi">}</span>
<span class="pi">{</span><span class="err">%</span><span class="nv">- import_yaml 'bind/zones-master.sls' as masters with context -%</span><span class="pi">}</span>
<span class="pi">{</span><span class="err">%</span><span class="nv">- import_yaml 'bind/zones-slave.sls' as slaves with context -%</span><span class="pi">}</span>
<span class="pi">{</span><span class="err">%</span><span class="nv">- import_yaml 'bind/zones-other.sls' as others with context -%</span><span class="pi">}</span>

<span class="pi">{</span><span class="err">%</span><span class="nv">- if grains</span><span class="pi">[</span><span class="s1">'</span><span class="s">dnsrole'</span><span class="pi">]</span> <span class="nv">== 'master' %</span><span class="pi">}</span>
<span class="pi">{</span><span class="err">%</span><span class="nv">- do named.bind.update(masters.bind) %</span><span class="pi">}</span>
<span class="pi">{</span><span class="err">%</span><span class="nv">- elif grains</span><span class="pi">[</span><span class="s1">'</span><span class="s">dnsrole'</span><span class="pi">]</span> <span class="nv">== 'slave' %</span><span class="pi">}</span>
<span class="pi">{</span><span class="err">%</span><span class="nv">- do named.bind.update(slaves.bind) %</span><span class="pi">}</span>
<span class="pi">{</span><span class="err">%</span><span class="nv">- endif %</span><span class="pi">}</span>

<span class="pi">{</span><span class="err">%</span><span class="nv">- do named.bind.zones.update(others.bind.zones) %</span><span class="pi">}</span>

<span class="pi">{{</span> <span class="nv">named</span> <span class="pi">}}</span>

</pre></table></code></div></div><p>This imports all YAML files, compiles them as dictionaries and basically makes them available as objects by the given name. Then we just use the power of Jijna2 and carry out a dictionary update on specific objects from a specific nested key. To me it is readable, centralised and keeps the control inside the bind pillar, yet giving the power of flexibility.</p><p>Minion targeting is now easy, keeping the <code class="language-plaintext highlighter-rouge">top.sls</code> clean and readable as possible:</p><div class="language-yaml highlighter-rouge"><div class="code-header"> <span data-label-text="YAML"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="na">base</span><span class="pi">:</span>
  <span class="s1">'</span><span class="s">roles:dns'</span><span class="err">:</span>
    <span class="pi">-</span> <span class="na">match</span><span class="pi">:</span> <span class="s">grain</span>
    <span class="pi">-</span> <span class="s">bind</span>
</pre></table></code></div></div></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/python/'>Python</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/python/" class="post-tag no-text-decoration" >python</a> <a href="/tags/salt/" class="post-tag no-text-decoration" >salt</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Merging Pillars in SaltStack - Ivan Adam Vari&amp;url=https://ivanvari.com/merging-pillars-in-saltstack/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Merging Pillars in SaltStack - Ivan Adam Vari&amp;u=https://ivanvari.com/merging-pillars-in-saltstack/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https://ivanvari.com/merging-pillars-in-saltstack/&amp;text=Merging Pillars in SaltStack - Ivan Adam Vari" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <a href="https://www.linkedin.com/sharing/share-offsite/?url=https://ivanvari.com/merging-pillars-in-saltstack/" data-toggle="tooltip" data-placement="top" title="Linkedin" target="_blank" rel="noopener" aria-label="Linkedin"> <i class="fa-fw fab fa-linkedin"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/aws/">aws</a> <a class="post-tag" href="/tags/cloud/">cloud</a> <a class="post-tag" href="/tags/cluster/">cluster</a> <a class="post-tag" href="/tags/couchbase/">couchbase</a> <a class="post-tag" href="/tags/network/">network</a> <a class="post-tag" href="/tags/nosql/">nosql</a> <a class="post-tag" href="/tags/python/">python</a> <a class="post-tag" href="/tags/cfn/">cfn</a> <a class="post-tag" href="/tags/cloudformation/">cloudformation</a> <a class="post-tag" href="/tags/hardware/">hardware</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="tail-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/script-clone-saltstack-formulas-github/"><div class="card-body"> <em class="timeago small" data-ts="1400867041" > 2014-05-23 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Script to Clone SaltStack Formulas from GitHub</h3><div class="text-muted small"><p> I am heavily into Salt infrastructure management at the moment, and wish to leverage all available (community written) formulas. Luckily, the SaltStack group maintains a collection of excellent for...</p></div></div></a></div><div class="card"> <a href="/running-pylint-in-pycharm/"><div class="card-body"> <em class="timeago small" data-ts="1404340888" > 2014-07-03 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Running Pylint in PyCharm</h3><div class="text-muted small"><p> I really liked the Pylintintegration in Eclipse/Pydev but I have switched to PyCharm since JetBrains released CE edition. Pycharm supports PEP8auditing “out of the box”, but I found out lately, tha...</p></div></div></a></div><div class="card"> <a href="/aws-codepipeline-stuck-at-cloudformation-prepare-stage/"><div class="card-body"> <em class="timeago small" data-ts="1654426722" > 2022-06-05 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>AWS Codepipeline Stuck at Cloudformation Prepare Stage</h3><div class="text-muted small"><p> This issue puzzled me and even AWS support for weeks, although for the later it was mostly because of their availability not their skills: I pushed in an update for one of my pipeline managed s...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/wd-mycloud-2t-nas-review/" class="btn btn-outline-primary" prompt="Older"><p>WD MyCloud 2T NAS Review</p></a> <a href="/solving-openvpn-poor-throughput-and-packet-loss/" class="btn btn-outline-primary" prompt="Newer"><p>Solving OpenVPN poor throughput and packet loss</p></a></div><div id="disqus_thread" class="pt-2 pb-2"><p class="text-center text-muted small"> Comments powered by <a href="https://disqus.com/">Disqus</a>.</p></div><script type="text/javascript"> var disqus_config = function () { this.page.url = 'https://ivanvari.com/merging-pillars-in-saltstack/'; this.page.identifier = '/merging-pillars-in-saltstack/'; }; /* Lazy loading */ var disqus_observer = new IntersectionObserver(function (entries) { if(entries[0].isIntersecting) { (function () { var d = document, s = d.createElement('script'); s.src = 'https://ivanvari-com.disqus.com/embed.js'; s.setAttribute('data-timestamp', +new Date()); (d.head || d.body).appendChild(s); })(); disqus_observer.disconnect(); } }, { threshold: [0] }); disqus_observer.observe(document.querySelector('#disqus_thread')); /* Auto switch theme */ function reloadDisqus() { /* Disqus hasn't been loaded */ if (typeof DISQUS === "undefined") { return; } if (document.readyState == 'complete') { DISQUS.reset({ reload: true, config: disqus_config }); } } const modeToggle = document.querySelector(".mode-toggle"); if (typeof modeToggle !== "undefined") { /* modeToggle.addEventListener('click', reloadDisqus); // not pretty for 'color-scheme' */ window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', reloadDisqus); } </script></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center text-muted"><div class="footer-left"><p class="mb-0"> © 2022 <a href="https://github.com/variia">Iván Ádám Vári</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/aws/">aws</a> <a class="post-tag" href="/tags/cloud/">cloud</a> <a class="post-tag" href="/tags/cluster/">cluster</a> <a class="post-tag" href="/tags/couchbase/">couchbase</a> <a class="post-tag" href="/tags/network/">network</a> <a class="post-tag" href="/tags/nosql/">nosql</a> <a class="post-tag" href="/tags/python/">python</a> <a class="post-tag" href="/tags/cfn/">cfn</a> <a class="post-tag" href="/tags/cloudformation/">cloudformation</a> <a class="post-tag" href="/tags/hardware/">hardware</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=UA-84719456-1"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'UA-84719456-1'); }); </script>
